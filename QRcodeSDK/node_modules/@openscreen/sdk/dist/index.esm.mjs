import e from"moment";import s from"axios";import{CognitoUser as t,CognitoUserPool as r,AuthenticationDetails as a,CognitoUserAttribute as n}from"amazon-cognito-identity-js";import{promises as o}from"fs";function i(){return i=Object.assign||function(e){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},i.apply(this,arguments)}class c{constructor(e){this.session=void 0,this.routeSegments=void 0,this.session=e}async makeUri(e={}){const s=[(await this.session.getCloudConfig()).endpoint.replace(/\/+$/,"")];return this.routeSegments.forEach(t=>{if(s.push(t.routePart),t.parm){const r=e[t.parm];if(!r)throw Error(`Openscreen: missing path parameter value for '${t.parm}'`);s.push(r)}}),s.join("/")}async getAuthorization(){const e=await this.session.getActiveSession();return`Bearer ${await e.getAccessToken().getJwtToken()}`}debugRequest(e,s,t,r,a){this.session.debugRequest&&(console.debug(`Openscreen REQUEST: ${e.toUpperCase()} ${s}`),r&&console.debug(`Openscreen REQUEST: ${JSON.stringify(r,null,2)}`),t&&this.session.debugQuery&&console.debug(`Openscreen QUERY: ${JSON.stringify(t,null,2)}`),a&&this.session.debugOptions&&console.debug(`Openscreen OPTIONS: ${JSON.stringify(a,null,2)}`))}debugResponse(e){this.session.debugResponse&&console.debug(`Openscreen RESPONSE: ${JSON.stringify(e.data||{},null,2)}`)}handleAndDebugErr(e){if(e.response&&e.response.data)return this.session.debugError?console.error(`Openscreen ERROR: ${JSON.stringify(e.response.data,null,2)}`):this.session.debugResponse&&console.error(`Openscreen RESPONSE: ${JSON.stringify(e.response.data,null,2)}`),e.response.data;if(this.session.debugError)try{console.error(e)}catch(e){console.error("Openscreen: (unable to print error)")}return e}}class u extends c{async go(e,s,t){try{const r=await this.makeUri(e),a={Authorization:await this.getAuthorization()};this.debugRequest("delete",r,s,null,t);const n=await this.session.getAxios(),o=await n.delete(r,i({headers:a,params:s},t));return this.debugResponse(o),o.data}catch(e){throw this.handleAndDebugErr(e)}}}class h extends c{async go(e,s,t){try{const r=await this.makeUri(e),a={Authorization:await this.getAuthorization()};this.debugRequest("get",r,s,null,t);const n=await this.session.getAxios(),o=await n.get(r,i({headers:a,params:s},t));return this.debugResponse(o),o.data}catch(e){throw this.handleAndDebugErr(e)}}}class d extends c{async go(e,s,t,r){try{const a=await this.makeUri(e),n={Authorization:await this.getAuthorization()};this.debugRequest("patch",a,s,t,r);const o=await this.session.getAxios(),c=await o.patch(a,t,i({headers:n,params:s},r));return this.debugResponse(c),c.data}catch(e){throw this.handleAndDebugErr(e)}}}class m extends c{async go(e,s,t,r){try{const a=await this.makeUri(e),n={Authorization:await this.getAuthorization()};this.debugRequest("post",a,s,t,r);const o=await this.session.getAxios(),c=await o.post(a,t,i({headers:n,params:s},r));return this.debugResponse(c),c.data}catch(e){throw this.handleAndDebugErr(e)}}}class p{constructor(e,s){this.session=void 0,this.pathParameters=void 0,this.session=e,this.pathParameters=s}self(){return this}getSession(){return this.session}}class g{constructor(e,s){this.session=void 0,this.pathParameters=void 0,this.id=void 0,this.session=e,this.pathParameters=s}getSession(){return this.session}}var P,l,w,S,N,I,v,x,y,k,f,A;!function(e){e.ACTIVE="ACTIVE",e.SUSPENDED="SUSPENDED"}(P||(P={})),function(e){e.OWNER="OWNER",e.ADMINISTRATOR="ADMINISTRATOR",e.BILLING_CONTACT="BILLING_CONTACT",e.MEMBER="MEMBER",e.API_KEY="API_KEY",e.INVITATION_DECLINED="INVITATION_DECLINED"}(l||(l={})),function(e){e.INDIVIDUAL_STARTER="individualStarter",e.INDIVIDUAL_PRO="individualPro",e.ENTERPRISE_STARTER="enterpriseStarter",e.ENTERPRISE_PRO="enterprisePro",e.ENTERPRISE_CUSTOM="enterpriseCustom",e.UNLIMITED="unlimited"}(w||(w={})),function(e){e.MONTHLY="monthly",e.ANNUAL="annual"}(S||(S={})),function(e){e.BASIC="basic",e.ADVANCED="advanced",e.basic="basic",e.advance="advanced"}(N||(N={})),function(e){e.ACTIVE="ACTIVE",e.SUSPENDED="SUSPENDED"}(I||(I={})),function(e){e.NO_SCAN_ID="NO_SCAN_ID",e.SCAN_ID_IN_PATH_PARAMETER="SCAN_ID_IN_PATH_PARAMETER",e.SCAN_ID_IN_QUERY_STRING_PARAMETER="SCAN_ID_IN_QUERY_STRING_PARAMETER"}(v||(v={})),function(e){e.L="L",e.M="M",e.Q="Q",e.H="H"}(x||(x={})),function(e){e.STATIC_REDIRECT="STATIC_REDIRECT",e.DYNAMIC_REDIRECT="DYNAMIC_REDIRECT",e.DYNAMIC_REDIRECT_TO_APP="DYNAMIC_REDIRECT_TO_APP"}(y||(y={})),function(e){e.SHORT_URL="SHORT_URL",e.HASHED_ID="HASHED_ID",e.SECURE_ID="SECURE_ID"}(k||(k={})),function(e){e.ACTIVE="ACTIVE",e.INACTIVE="INACTIVE",e.SUSPENDED="SUSPENDED"}(f||(f={})),function(e){e.PNG="PNG",e.JPEG="JPEG",e.SVG="SVG",e.png="png",e.jpeg="jpeg",e.svg="svg"}(A||(A={}));class E extends m{constructor(...e){super(...e),this.routeSegments=[{parm:"accountId",routePart:"accounts",sdkPartName:"account"},{routePart:"invitations",sdkPartName:"invitations"}]}}class b extends m{constructor(...e){super(...e),this.routeSegments=[{parm:"accountId",routePart:"accounts",sdkPartName:"account"},{routePart:"projects",sdkPartName:"projects"}]}}class C extends m{constructor(...e){super(...e),this.routeSegments=[{parm:"invitationId",routePart:"invitations",sdkPartName:"invitation"},{routePart:"users",sdkPartName:"users"}]}}class R extends u{constructor(...e){super(...e),this.routeSegments=[{parm:"accountId",routePart:"accounts",sdkPartName:"account"}]}}class T extends u{constructor(...e){super(...e),this.routeSegments=[{parm:"invitationId",routePart:"invitations",sdkPartName:"invitation"}]}}class U extends u{constructor(...e){super(...e),this.routeSegments=[{parm:"accountId",routePart:"accounts",sdkPartName:"account"},{parm:"userId",routePart:"users",sdkPartName:"user"}]}}class O extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"accountId",routePart:"accounts",sdkPartName:"account"}]}}class j extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"accountId",routePart:"accounts",sdkPartName:"account"},{routePart:"assets",sdkPartName:"assets"}]}}class _ extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"accountId",routePart:"accounts",sdkPartName:"account"},{routePart:"contacts",sdkPartName:"contacts"}]}}class D extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"invitationId",routePart:"invitations",sdkPartName:"invitation"}]}}class q extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"accountId",routePart:"accounts",sdkPartName:"account"},{routePart:"priceplan",sdkPartName:"pricePlan"}]}}class $ extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"accountId",routePart:"accounts",sdkPartName:"account"},{routePart:"projects",sdkPartName:"projects"}]}}class G extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"accountId",routePart:"accounts",sdkPartName:"account"},{routePart:"qrcodes",sdkPartName:"qrCodes"}]}}class L extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"accountId",routePart:"accounts",sdkPartName:"account"},{routePart:"scans",sdkPartName:"scans"}]}}class M extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"accountId",routePart:"accounts",sdkPartName:"account"},{routePart:"users",sdkPartName:"users"}]}}class z extends d{constructor(...e){super(...e),this.routeSegments=[{parm:"accountId",routePart:"accounts",sdkPartName:"account"}]}}class B extends d{constructor(...e){super(...e),this.routeSegments=[{parm:"accountId",routePart:"accounts",sdkPartName:"account"},{routePart:"priceplan",sdkPartName:"pricePlan"}]}}class V extends m{constructor(...e){super(...e),this.routeSegments=[{parm:"assetId",routePart:"assets",sdkPartName:"asset"},{routePart:"contacts",sdkPartName:"contacts"}]}}class Q extends m{constructor(...e){super(...e),this.routeSegments=[{parm:"assetId",routePart:"assets",sdkPartName:"asset"},{routePart:"qrcodes",sdkPartName:"qrCodes"}]}}class H extends u{constructor(...e){super(...e),this.routeSegments=[{parm:"assetId",routePart:"assets",sdkPartName:"asset"}]}}class J extends u{constructor(...e){super(...e),this.routeSegments=[{parm:"groupId",routePart:"assetGroups",sdkPartName:"assetGroup"}]}}class Y extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"assetId",routePart:"assets",sdkPartName:"asset"}]}}class F extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"groupId",routePart:"assetGroups",sdkPartName:"assetGroup"}]}}class K extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"assetId",routePart:"assets",sdkPartName:"asset"},{routePart:"contacts",sdkPartName:"contacts"}]}}class W extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"assetId",routePart:"assets",sdkPartName:"asset"},{routePart:"qrcodes",sdkPartName:"qrCodes"}]}}class X extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"assetId",routePart:"assets",sdkPartName:"asset"},{routePart:"scans",sdkPartName:"scans"}]}}class Z extends m{constructor(...e){super(...e),this.routeSegments=[{parm:"assetId",routePart:"assets",sdkPartName:"asset"},{parm:"contactId",routePart:"contacts",sdkPartName:"contact"}]}}class ee extends u{constructor(...e){super(...e),this.routeSegments=[{parm:"assetId",routePart:"assets",sdkPartName:"asset"},{parm:"contactId",routePart:"contacts",sdkPartName:"contact"}]}}class se extends d{constructor(...e){super(...e),this.routeSegments=[{parm:"assetId",routePart:"assets",sdkPartName:"asset"}]}}class te extends m{constructor(...e){super(...e),this.routeSegments=[{routePart:"auth/getAccessToken",sdkPartName:"authGetAccessToken"}]}}class re extends u{constructor(...e){super(...e),this.routeSegments=[{parm:"contactId",routePart:"contacts",sdkPartName:"contact"}]}}class ae extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"contactId",routePart:"contacts",sdkPartName:"contact"}]}}class ne extends d{constructor(...e){super(...e),this.routeSegments=[{parm:"contactId",routePart:"contacts",sdkPartName:"contact"}]}}class oe extends h{constructor(...e){super(...e),this.routeSegments=[{routePart:"overview/accounts",sdkPartName:"overviewAccounts"}]}}class ie extends h{constructor(...e){super(...e),this.routeSegments=[{routePart:"overview/activity",sdkPartName:"overviewActivity"}]}}class ce extends h{constructor(...e){super(...e),this.routeSegments=[{routePart:"overview/users",sdkPartName:"overviewUsers"}]}}class ue extends m{constructor(...e){super(...e),this.routeSegments=[{parm:"projectId",routePart:"projects",sdkPartName:"project"},{routePart:"assets",sdkPartName:"assets"}]}}class he extends m{constructor(...e){super(...e),this.routeSegments=[{parm:"projectId",routePart:"projects",sdkPartName:"project"},{routePart:"assetGroups",sdkPartName:"assetGroups"}]}}class de extends m{constructor(...e){super(...e),this.routeSegments=[{parm:"projectId",routePart:"projects",sdkPartName:"project"},{routePart:"assets/batch",sdkPartName:"assetsBatch"}]}}class me extends m{constructor(...e){super(...e),this.routeSegments=[{parm:"projectId",routePart:"projects",sdkPartName:"project"},{routePart:"contacts",sdkPartName:"contacts"}]}}class pe extends m{constructor(...e){super(...e),this.routeSegments=[{parm:"projectId",routePart:"projects",sdkPartName:"project"},{routePart:"contacts/batch",sdkPartName:"contactsBatch"}]}}class ge extends m{constructor(...e){super(...e),this.routeSegments=[{parm:"projectId",routePart:"projects",sdkPartName:"project"},{routePart:"qrcodes",sdkPartName:"qrCodes"}]}}class Pe extends m{constructor(...e){super(...e),this.routeSegments=[{parm:"projectId",routePart:"projects",sdkPartName:"project"},{routePart:"smstemplates",sdkPartName:"smsTemplates"}]}}class le extends u{constructor(...e){super(...e),this.routeSegments=[{parm:"projectId",routePart:"projects",sdkPartName:"project"}]}}class we extends u{constructor(...e){super(...e),this.routeSegments=[{parm:"projectId",routePart:"projects",sdkPartName:"project"},{parm:"smsTemplateName",routePart:"smstemplates",sdkPartName:"smsTemplate"}]}}class Se extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"projectId",routePart:"projects",sdkPartName:"project"},{routePart:"assets",sdkPartName:"assets"}]}}class Ne extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"projectId",routePart:"projects",sdkPartName:"project"},{routePart:"contacts",sdkPartName:"contacts"}]}}class Ie extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"projectId",routePart:"projects",sdkPartName:"project"}]}}class ve extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"projectId",routePart:"projects",sdkPartName:"project"},{routePart:"qrcodes",sdkPartName:"qrCodes"}]}}class xe extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"projectId",routePart:"projects",sdkPartName:"project"},{routePart:"scans",sdkPartName:"scans"}]}}class ye extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"projectId",routePart:"projects",sdkPartName:"project"},{parm:"smsTemplateName",routePart:"smstemplates",sdkPartName:"smsTemplate"}]}}class ke extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"projectId",routePart:"projects",sdkPartName:"project"},{routePart:"smstemplates",sdkPartName:"smsTemplates"}]}}class fe extends d{constructor(...e){super(...e),this.routeSegments=[{parm:"projectId",routePart:"projects",sdkPartName:"project"}]}}class Ae extends d{constructor(...e){super(...e),this.routeSegments=[{parm:"projectId",routePart:"projects",sdkPartName:"project"},{parm:"smsTemplateName",routePart:"smstemplates",sdkPartName:"smsTemplate"}]}}class Ee extends u{constructor(...e){super(...e),this.routeSegments=[{parm:"qrCodeId",routePart:"qrcodes",sdkPartName:"qrCode"}]}}class be extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"qrCodeId",routePart:"qrcodes",sdkPartName:"qrCode"}]}}class Ce extends d{constructor(...e){super(...e),this.routeSegments=[{parm:"qrCodeId",routePart:"qrcodes",sdkPartName:"qrCode"}]}}class Re extends m{constructor(...e){super(...e),this.routeSegments=[{parm:"scanId",routePart:"scans",sdkPartName:"scan"},{routePart:"contacts",sdkPartName:"contacts"}]}}class Te extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"scanId",routePart:"scans",sdkPartName:"scan"}]}}class Ue extends m{constructor(...e){super(...e),this.routeSegments=[{parm:"scanId",routePart:"scans",sdkPartName:"scan"},{routePart:"sms",sdkPartName:"sms"}]}}class Oe extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"accountId",routePart:"search/accounts",sdkPartName:"searchAccount"}]}}class je extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"userId",routePart:"search/users",sdkPartName:"searchUser"}]}}class _e extends h{constructor(...e){super(...e),this.routeSegments=[{routePart:"search/accounts",sdkPartName:"searchAccounts"}]}}class De extends h{constructor(...e){super(...e),this.routeSegments=[{routePart:"search/users",sdkPartName:"searchUsers"}]}}class qe extends m{constructor(...e){super(...e),this.routeSegments=[{parm:"userId",routePart:"users",sdkPartName:"user"},{routePart:"accounts",sdkPartName:"accounts"}]}}class $e extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"userId",routePart:"users",sdkPartName:"user"},{routePart:"accounts",sdkPartName:"accounts"}]}}class Ge extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"userId",routePart:"users",sdkPartName:"user"},{routePart:"errors",sdkPartName:"errors"}]}}class Le extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"userId",routePart:"users",sdkPartName:"user"},{routePart:"invitations",sdkPartName:"invitations"}]}}class Me extends h{constructor(...e){super(...e),this.routeSegments=[{parm:"userId",routePart:"users",sdkPartName:"user"}]}}class ze extends d{constructor(...e){super(...e),this.routeSegments=[{parm:"userId",routePart:"users",sdkPartName:"user"}]}}class Be extends p{async create(e,s){return new E(this.session).go(this.pathParameters,void 0,e,s)}}class Ve extends p{async create(e,s){return new b(this.session).go(this.pathParameters,void 0,e,s)}async get(e,s){return new $(this.session).go(this.pathParameters,e,s)}}class Qe extends g{async delete(e){return new U(this.session).go(this.pathParameters,void 0,e)}}class He extends p{async get(e,s){return new j(this.session).go(this.pathParameters,e,s)}}class Je extends p{async get(e,s){return new _(this.session).go(this.pathParameters,e,s)}}class Ye extends p{async get(e){return new q(this.session).go(this.pathParameters,void 0,e)}async update(e,s){return new B(this.session).go(this.pathParameters,void 0,e,s)}}class Fe extends p{async get(e,s){return new G(this.session).go(this.pathParameters,e,s)}}class Ke extends p{async get(e,s){return new L(this.session).go(this.pathParameters,e,s)}}class We extends p{async get(e,s){return new M(this.session).go(this.pathParameters,e,s)}}class Xe extends g{invitations(){return new Be(this.getSession(),this.pathParameters)}projects(){return new Ve(this.getSession(),this.pathParameters)}user(e){return new Qe(this.getSession(),i({},this.pathParameters,{userId:e}))}assets(){return new He(this.getSession(),this.pathParameters)}contacts(){return new Je(this.getSession(),this.pathParameters)}pricePlan(){return new Ye(this.getSession(),this.pathParameters)}qrCodes(){return new Fe(this.getSession(),this.pathParameters)}scans(){return new Ke(this.getSession(),this.pathParameters)}users(){return new We(this.getSession(),this.pathParameters)}async delete(e){return new R(this.session).go(this.pathParameters,void 0,e)}async get(e){return new O(this.session).go(this.pathParameters,void 0,e)}async update(e,s){return new z(this.session).go(this.pathParameters,void 0,e,s)}}class Ze extends p{async create(e){return new C(this.session).go(this.pathParameters,void 0,e)}}class es extends g{users(){return new Ze(this.getSession(),this.pathParameters)}async delete(e){return new T(this.session).go(this.pathParameters,void 0,e)}async get(e){return new D(this.session).go(this.pathParameters,void 0,e)}}class ss extends p{async create(e,s){return new V(this.session).go(this.pathParameters,void 0,e,s)}async get(e,s){return new K(this.session).go(this.pathParameters,e,s)}}class ts extends p{async create(e,s){return new Q(this.session).go(this.pathParameters,void 0,e,s)}async get(e,s){return new W(this.session).go(this.pathParameters,e,s)}}class rs extends p{async get(e,s){return new X(this.session).go(this.pathParameters,e,s)}}class as extends g{async link(e,s){return new Z(this.session).go(this.pathParameters,void 0,e,s)}async unlink(e){return new ee(this.session).go(this.pathParameters,void 0,e)}}class ns extends g{contacts(){return new ss(this.getSession(),this.pathParameters)}qrCodes(){return new ts(this.getSession(),this.pathParameters)}scans(){return new rs(this.getSession(),this.pathParameters)}contact(e){return new as(this.getSession(),i({},this.pathParameters,{contactId:e}))}async delete(e){return new H(this.session).go(this.pathParameters,void 0,e)}async get(e){return new Y(this.session).go(this.pathParameters,void 0,e)}async update(e,s){return new se(this.session).go(this.pathParameters,void 0,e,s)}}class os extends g{async delete(e){return new J(this.session).go(this.pathParameters,void 0,e)}async get(e,s){return new F(this.session).go(this.pathParameters,e,s)}}class is extends p{async create(e,s){return new te(this.session).go(this.pathParameters,void 0,e,s)}}class cs extends g{async delete(e){return new re(this.session).go(this.pathParameters,void 0,e)}async get(e){return new ae(this.session).go(this.pathParameters,void 0,e)}async update(e,s){return new ne(this.session).go(this.pathParameters,void 0,e,s)}}class us extends p{async get(e){return new oe(this.session).go(this.pathParameters,void 0,e)}}class hs extends p{async get(e){return new ie(this.session).go(this.pathParameters,void 0,e)}}class ds extends p{async get(e){return new ce(this.session).go(this.pathParameters,void 0,e)}}class ms extends p{async create(e,s){return new ue(this.session).go(this.pathParameters,void 0,e,s)}async get(e,s){return new Se(this.session).go(this.pathParameters,e,s)}}class ps extends p{async create(e,s){return new he(this.session).go(this.pathParameters,void 0,e,s)}}class gs extends p{async create(e,s){return new de(this.session).go(this.pathParameters,void 0,e,s)}}class Ps extends p{async create(e,s){return new me(this.session).go(this.pathParameters,void 0,e,s)}async get(e,s){return new Ne(this.session).go(this.pathParameters,e,s)}}class ls extends p{async create(e,s){return new pe(this.session).go(this.pathParameters,void 0,e,s)}}class ws extends p{async create(e,s){return new ge(this.session).go(this.pathParameters,void 0,e,s)}async get(e,s){return new ve(this.session).go(this.pathParameters,e,s)}}class Ss extends p{async create(e,s){return new Pe(this.session).go(this.pathParameters,void 0,e,s)}async get(e,s){return new ke(this.session).go(this.pathParameters,e,s)}}class Ns extends g{async delete(e){return new we(this.session).go(this.pathParameters,void 0,e)}async get(e){return new ye(this.session).go(this.pathParameters,void 0,e)}async update(e){return new Ae(this.session).go(this.pathParameters,void 0,e)}}class Is extends p{async get(e,s){return new xe(this.session).go(this.pathParameters,e,s)}}class vs extends g{assets(){return new ms(this.getSession(),this.pathParameters)}assetGroups(){return new ps(this.getSession(),this.pathParameters)}assetsBatch(){return new gs(this.getSession(),this.pathParameters)}contacts(){return new Ps(this.getSession(),this.pathParameters)}contactsBatch(){return new ls(this.getSession(),this.pathParameters)}qrCodes(){return new ws(this.getSession(),this.pathParameters)}smsTemplates(){return new Ss(this.getSession(),this.pathParameters)}smsTemplate(e){return new Ns(this.getSession(),i({},this.pathParameters,{smsTemplateName:e}))}scans(){return new Is(this.getSession(),this.pathParameters)}async delete(e){return new le(this.session).go(this.pathParameters,void 0,e)}async get(e){return new Ie(this.session).go(this.pathParameters,void 0,e)}async update(e,s){return new fe(this.session).go(this.pathParameters,void 0,e,s)}}class xs extends g{async delete(e){return new Ee(this.session).go(this.pathParameters,void 0,e)}async get(e,s){return new be(this.session).go(this.pathParameters,e,s)}async update(e,s){return new Ce(this.session).go(this.pathParameters,void 0,e,s)}}class ys extends p{async create(e,s){return new Re(this.session).go(this.pathParameters,void 0,e,s)}}class ks extends p{async send(e,s){return new Ue(this.session).go(this.pathParameters,void 0,e,s)}}class fs extends g{contacts(){return new ys(this.getSession(),this.pathParameters)}sms(){return new ks(this.getSession(),this.pathParameters)}async get(e){return new Te(this.session).go(this.pathParameters,void 0,e)}}class As extends g{async get(e){return new Oe(this.session).go(this.pathParameters,void 0,e)}}class Es extends g{async get(e){return new je(this.session).go(this.pathParameters,void 0,e)}}class bs extends p{async get(e,s){return new _e(this.session).go(this.pathParameters,e,s)}}class Cs extends p{async get(e,s){return new De(this.session).go(this.pathParameters,e,s)}}class Rs extends p{async create(e,s){return new qe(this.session).go(this.pathParameters,void 0,e,s)}async get(e,s){return new $e(this.session).go(this.pathParameters,e,s)}}class Ts extends p{async get(e,s){return new Ge(this.session).go(this.pathParameters,e,s)}}class Us extends p{async get(e,s){return new Le(this.session).go(this.pathParameters,e,s)}}class Os extends g{accounts(){return new Rs(this.getSession(),this.pathParameters)}errors(){return new Ts(this.getSession(),this.pathParameters)}invitations(){return new Us(this.getSession(),this.pathParameters)}async get(e){return new Me(this.session).go(this.pathParameters,void 0,e)}async update(e,s){return new ze(this.session).go(this.pathParameters,void 0,e,s)}}class js extends p{account(e){return new Xe(this.getSession(),i({},this.pathParameters,{accountId:e}))}invitation(e){return new es(this.getSession(),i({},this.pathParameters,{invitationId:e}))}asset(e){return new ns(this.getSession(),i({},this.pathParameters,{assetId:e}))}assetGroup(e){return new os(this.getSession(),i({},this.pathParameters,{groupId:e}))}authGetAccessToken(){return new is(this.getSession(),this.pathParameters)}contact(e){return new cs(this.getSession(),i({},this.pathParameters,{contactId:e}))}overviewAccounts(){return new us(this.getSession(),this.pathParameters)}overviewActivity(){return new hs(this.getSession(),this.pathParameters)}overviewUsers(){return new ds(this.getSession(),this.pathParameters)}project(e){return new vs(this.getSession(),i({},this.pathParameters,{projectId:e}))}qrCode(e){return new xs(this.getSession(),i({},this.pathParameters,{qrCodeId:e}))}scan(e){return new fs(this.getSession(),i({},this.pathParameters,{scanId:e}))}searchAccount(e){return new As(this.getSession(),i({},this.pathParameters,{accountId:e}))}searchUser(e){return new Es(this.getSession(),i({},this.pathParameters,{userId:e}))}searchAccounts(){return new bs(this.getSession(),this.pathParameters)}searchUsers(){return new Cs(this.getSession(),this.pathParameters)}user(e){return new Os(this.getSession(),i({},this.pathParameters,{userId:e}))}}class _s extends t{async authenticateUser(e){return new Promise((s,t)=>{super.authenticateUser(e,{onSuccess:e=>s({session:e}),onFailure:e=>t(e),mfaRequired:(e,t)=>s({challengeName:e,challengeParameters:t}),selectMFAType:(e,t)=>s({challengeName:e,challengeParameters:t}),mfaSetup:(e,t)=>s({challengeName:e,challengeParameters:t}),totpRequired:(e,t)=>s({challengeName:e,challengeParameters:t}),customChallenge:e=>s({challengeParameters:e})})})}async getSession(){return new Promise((e,s)=>{super.getSession((t,r)=>t?s(t):e(r))})}}class Ds extends r{getStorage(){return this.storage}getClientId(){return this.clientId}async signUp(e,s,t,r){return new Promise((a,n)=>{super.signUp(e,s,t,r,(e,s)=>e?n(e):a(s))})}}class qs{constructor(e,s,t){this.userPool=void 0,this.userPool=new Ds({UserPoolId:e,ClientId:s,Storage:t})}getCognitoUserPool(){return this.userPool}getStorage(){return this.userPool.getStorage()}getUser(e){if(e){const s=this.userPool.getStorage().getItem(`keyToUsername.${Buffer.from(e).toString("base64")}`);return s?new _s({Username:s,Pool:this.userPool,Storage:this.userPool.getStorage()}):null}const s=this.userPool.getStorage().getItem(`CognitoIdentityServiceProvider.${this.userPool.getClientId()}.LastAuthUser`);return s?new _s({Username:s,Pool:this.userPool,Storage:this.userPool.getStorage()}):null}async authenticate(e,s){const t=new _s({Username:e,Pool:this.userPool,Storage:this.userPool.getStorage()}),r=new a({Username:e,Password:s});return t.authenticateUser(r).then(s=>{if(s.session){const s=t.getUsername();return this.userPool.getStorage().setItem(`keyToUsername.${Buffer.from(e).toString("base64")}`,s),t}return null})}async signUp(e,s,t){const r=[];return r.push(new n({Name:"given_name",Value:t.givenName})),r.push(new n({Name:"middle_name",Value:t.middleName})),r.push(new n({Name:"family_name",Value:t.familyName})),r.push(new n({Name:"phone_number",Value:t.phoneNumber})),r.push(new n({Name:"email",Value:e})),this.userPool.signUp(e,s,r,[])}}class $s{constructor(){this.debugConfig=!1,this.debugAuth=!1,this.debugRequest=!1,this.debugResponse=!1,this.debugError=!1,this.debugQuery=!1,this.debugOptions=!1}getConfig(){throw Error("no session")}getCloudConfig(){throw Error("no session")}getActiveUser(){throw Error("no session")}getActiveSession(){throw Error("no session")}getAxios(){throw Error("no session")}}class Gs extends js{constructor(){super(new $s,{}),this._config=void 0,this.cloudConfigName=void 0,this.cloudConfig=void 0,this.userPool=void 0,this.userId=void 0,this.usingApiKey=!1,this.isAdministrator=void 0,this.activeUser=void 0,this.axios=void 0,this.debugConfig=!1,this.debugAuth=!1,this.debugRequest=!1,this.debugResponse=!1,this.debugError=!1,this.debugQuery=!1,this.debugOptions=!1;let{OS_DEBUG:e}=process.env;if(e){let s;switch(console.log(`OS_DEBUG=${e}`),e=e.toLowerCase(),e){case"all":this.debugConfig=!0,this.debugAuth=!0,this.debugRequest=!0,this.debugResponse=!0,this.debugError=!0,this.debugQuery=!0,this.debugOptions=!0;break;case"none":case"off":case"false":case"":this.debugConfig=!1,this.debugAuth=!1,this.debugRequest=!1,this.debugResponse=!1,this.debugError=!1,this.debugQuery=!1,this.debugOptions=!1;break;default:s=e.split(","),this.debugConfig=s.includes("config"),this.debugAuth=s.includes("auth"),this.debugRequest=s.includes("request"),this.debugResponse=s.includes("response"),this.debugError=s.includes("error"),this.debugQuery=s.includes("query"),this.debugOptions=s.includes("options"),this.debugConfig||this.debugAuth||this.debugRequest||this.debugResponse||this.debugError||this.debugQuery||this.debugOptions||console.warn(`Openscreen: OS_DEBUG environment var has invalid value: '${process.env.OS_DEBUG}'`)}}}getSession(){return this}config(e){if(this._config)throw Error("Openscreen: client is already configured");if(e.key){if(!e.secret)throw Error("Openscreen: invalid config, secret is missing");if(e.email||e.password)throw Error("Openscreen: invalid config, use either API key and secret, or email and password, but not both");this.usingApiKey=!0}else{if(!e.email)throw Error("Openscreen: invalid config, provide API key and secret, or email and password");if(!e.password)throw Error("Openscreen: invalid config, password is missing");if(e.key||e.secret)throw Error("Openscreen: invalid config, use either API key and secret, or email and password, but not both")}return"string"==typeof e.environment?this.cloudConfigName=e.environment:"object"==typeof e.environment?this.cloudConfig=Promise.resolve(e.environment):this.cloudConfigName="prod-aNCxEnLyMSsR8sso",this._config=e,this}getConfig(){if(!this._config)throw Error("Openscreen: client must be configured before accessing resources");return this._config}async authorize(){const s=this.getConfig();if(this.debugConfig){const e=i({},s);e.secret&&(e.secret="*".repeat(e.secret.length)),e.password&&(e.password="*".repeat(e.password.length)),console.debug(`Openscreen CONFIG: ${JSON.stringify(e,null,2)}`)}const t=await this.getCloudConfig();let r,a,n,o,c;this.debugConfig&&console.debug(`Openscreen CONFIG: (environment) ${JSON.stringify(t,null,2)}`),this.usingApiKey?(r="API key",a=s.key,n=s.secret,o=t.apiPoolId,c=t.apiClientId):(r="email",a=s.email,n=s.password,o=t.userPoolId,c=t.userClientId),this.userPool=new qs(o,c,s.storage);let u,h=this.userPool.getUser(a);h&&(this.debugAuth&&console.info(`Openscreen AUTH: authorized ${r} '${a}' retrieved from cache`),await h.getSession().then(e=>{u=e}).catch(e=>{this.debugAuth&&console.info(`Openscreen AUTH: ${e}`),h=null})),h||(this.debugAuth&&console.info(`Openscreen AUTH: authorizing ${r} '${a}'`),h=await this.userPool.authenticate(a,n),u=await h.getSession());const d=u.getIdToken(),m=d.payload;this.userId=m.sub;const p=m["cognito:groups"];return this.isAdministrator=p&&p.includes("appadmin"),this.debugAuth&&(m.email?console.info(`Openscreen AUTH: authorized as '${m.email}' (userId: ${m.sub}${this.isAdministrator?", administrator":""}), session expires ${e(1e3*d.getExpiration()).fromNow()}, authorized ${e(1e3*d.getIssuedAt()).fromNow()}`):console.info(`Openscreen AUTH: authorized as userId: ${m.sub}${this.isAdministrator?" (administrator)":""}, session expires ${e(1e3*d.getExpiration()).fromNow()}, authorized ${e(1e3*d.getIssuedAt()).fromNow()}`)),h}async getCloudConfig(){if(!this.cloudConfig){if(!this.cloudConfigName)throw Error("Openscreen: environment name missing");this.cloudConfig=async function(e){const t=s.create({baseURL:"https://config.openscreen.com",timeout:25e3,responseType:"json",maxContentLength:10240,maxBodyLength:10240,maxRedirects:1,decompress:!0}),r=await t.get(`${e}.json`).catch(s=>{throw new Error(`Openscreen: unable to load cloud configuration '${e}': ${s.message}`)}),{data:a}=r;return e.startsWith("web-")?{region:a.region,userPoolId:a.poolId,userClientId:a.clientId,apiPoolId:"",apiClientId:"",endpoint:a.endpoint,axios:a.axios}:e.startsWith("api-")?{region:a.region,userPoolId:"",userClientId:"",apiPoolId:a.poolId,apiClientId:a.clientId,endpoint:a.endpoint,axios:a.axios}:a}(this.cloudConfigName)}return this.cloudConfig}async getActiveUser(){return this.activeUser||(this.activeUser=this.authorize()),this.activeUser}async getActiveSession(){let e=await this.getActiveUser();try{return await e.getSession()}catch(s){return this.activeUser=this.authorize(),e=await this.activeUser,await e.getSession()}}async authorizedUserId(){return await this.getActiveUser(),this.userId||""}async amIAdministrator(){return await this.getActiveUser(),!0===this.isAdministrator}async getAxios(){if(this.axios)return s;const e=await this.getCloudConfig();return this.axios=s.create(e.axios||{timeout:25e3,responseType:"json",maxContentLength:1048576,maxBodyLength:1048576,maxRedirects:1,decompress:!0}),s}async saveQrImageDataToFile(e,s){const t=e.image;if(!t||!t.data||!t.options)throw new Error(`No valid image data present for QR code, qrCodeId='${e.qrCodeId||""}'`);const r=e.image.options.format.toLowerCase();if("png"===r){let t;t=e.image.options.dataUrl?Buffer.from(e.image.data.replace(/^data:image\/\w+;base64,/,""),"base64").toString("binary"):Buffer.from(e.image.data,"base64").toString("binary"),s||(s=`${e.qrCodeId}.png`),await o.writeFile(s,t,"binary")}else{if("svg"!==r)throw Error("QR code image data was not returned in 'png' or 'svg' format");s||(s=`${e.qrCodeId}.svg`),await o.writeFile(s,e.image.data)}}}export{P as AccountStatus,l as AccountUserRole,qe as CreateAccountByUserIdRequest,ue as CreateAssetByProjectIdRequest,he as CreateAssetGroupByProjectIdRequest,de as CreateAssetsByProjectIdRequest,V as CreateContactByAssetIdRequest,me as CreateContactByProjectIdRequest,Re as CreateContactByScanIdRequest,pe as CreateContactsByProjectIdRequest,E as CreateInvitationByAccountIdRequest,b as CreateProjectByAccountIdRequest,Q as CreateQrCodeByAssetIdRequest,ge as CreateQrCodeByProjectIdRequest,Pe as CreateSmsTemplateByProjectIdRequest,C as CreateUserByInvitationIdRequest,R as DeleteAccountRequest,J as DeleteAssetGroupRequest,H as DeleteAssetRequest,re as DeleteContactRequest,T as DeleteInvitationRequest,le as DeleteProjectRequest,Ee as DeleteQrCodeRequest,we as DeleteSmsTemplateByProjectIdRequest,U as DeleteUserByAccountIdRequest,te as GetAccessTokenRequest,Oe as GetAccountDetailsRequest,O as GetAccountRequest,$e as GetAccountsByUserIdRequest,oe as GetAccountsOverviewRequest,ie as GetActivityOverviewRequest,F as GetAssetGroupRequest,Y as GetAssetRequest,j as GetAssetsByAccountIdRequest,Se as GetAssetsByProjectIdRequest,ae as GetContactRequest,_ as GetContactsByAccountIdRequest,K as GetContactsByAssetIdRequest,Ne as GetContactsByProjectIdRequest,Ge as GetErrorsByUserIdRequest,D as GetInvitationRequest,Le as GetInvitationsByUserIdRequest,q as GetPricePlanByAccountIdRequest,Ie as GetProjectByProjectIdRequest,$ as GetProjectsByAccountIdRequest,be as GetQrCodeRequest,G as GetQrCodesByAccountIdRequest,W as GetQrCodesByAssetIdRequest,ve as GetQrCodesByProjectIdRequest,Te as GetScanRequest,L as GetScansByAccountIdRequest,X as GetScansByAssetIdRequest,xe as GetScansByProjectIdRequest,ye as GetSmsTemplateByProjectIdRequest,ke as GetSmsTemplatesByProjectIdRequest,je as GetUserDetailsRequest,Me as GetUserRequest,M as GetUsersByAccountIdRequest,ce as GetUsersOverviewRequest,Z as LinkContactToAssetRequest,Gs as Openscreen,w as PricePlanName,S as PricePlanPaymentPeriod,N as PricePlanReporting,I as ProjectStatus,v as QrCodeDynamicRedirectType,x as QrCodeErrorCorrectionLevel,y as QrCodeIntentType,k as QrCodeLocatorKeyType,f as QrCodeStatus,A as QrCodeType,He as SdkAccountAssetsResources,Je as SdkAccountContactsResources,Be as SdkAccountInvitationsResources,Ye as SdkAccountPricePlanResources,Ve as SdkAccountProjectsResources,Fe as SdkAccountQrCodesResources,Xe as SdkAccountResource,Ke as SdkAccountScansResources,Qe as SdkAccountUserResource,We as SdkAccountUsersResources,as as SdkAssetContactResource,ss as SdkAssetContactsResources,os as SdkAssetGroupResource,ts as SdkAssetQrCodesResources,ns as SdkAssetResource,rs as SdkAssetScansResources,is as SdkAuthGetAccessTokenResources,cs as SdkContactResource,es as SdkInvitationResource,Ze as SdkInvitationUsersResources,us as SdkOverviewAccountsResources,hs as SdkOverviewActivityResources,ds as SdkOverviewUsersResources,ps as SdkProjectAssetGroupsResources,gs as SdkProjectAssetsBatchResources,ms as SdkProjectAssetsResources,ls as SdkProjectContactsBatchResources,Ps as SdkProjectContactsResources,ws as SdkProjectQrCodesResources,vs as SdkProjectResource,Is as SdkProjectScansResources,Ns as SdkProjectSmsTemplateResource,Ss as SdkProjectSmsTemplatesResources,xs as SdkQrCodeResource,js as SdkResources,ys as SdkScanContactsResources,fs as SdkScanResource,ks as SdkScanSmsResources,As as SdkSearchAccountResource,bs as SdkSearchAccountsResources,Es as SdkSearchUserResource,Cs as SdkSearchUsersResources,Rs as SdkUserAccountsResources,Ts as SdkUserErrorsResources,Us as SdkUserInvitationsResources,Os as SdkUserResource,_e as SearchAccountsRequest,De as SearchUsersRequest,Ue as SendSmsByScanIdRequest,ee as UnlinkContactToAssetRequest,z as UpdateAccountRequest,se as UpdateAssetRequest,ne as UpdateContactRequest,B as UpdatePricePlanByAccountIdRequest,fe as UpdateProjectByProjectIdRequest,Ce as UpdateQrCodeRequest,Ae as UpdateSmsTemplateRequest,ze as UpdateUserRequest};
//# sourceMappingURL=index.esm.mjs.map
